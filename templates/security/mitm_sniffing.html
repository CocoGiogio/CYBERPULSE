{% extends "base.html" %}

{% block content %}
<section id="mitm_sniffing" class="container mt-5">
    <div class="text-center mb-4">
        <h2 class="section-title">üíÄ MITM & Sniffing</h2>
        <p class="project-description">
            Lancez une attaque Man-In-The-Middle et √©coutez le trafic HTTP en temps r√©el sur votre r√©seau local.
        </p>
    </div>

    <!-- MITM Start Form -->
    <form method="POST" class="row justify-content-center g-2">
        <div class="col-md-4">
            <input type="text" class="form-control" name="gatewayIP" placeholder="Ex: 192.168.1.1" required>
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-danger">
                D√©marrer MITM
            </button>
        </div>
    </form>

    <!-- Sniffer Start Form -->
    <form method="POST" class="row justify-content-center g-2 mt-3">
        <div class="col-md-4">
            <input type="text" class="form-control" name="interface" placeholder="Ex: eth0 ou wlan0" required>
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-warning">
                D√©marrer Sniffing
            </button>
        </div>
    </form>

    <!-- MITM Logs -->
    {% if mitm_logs %}
    <section class="mt-5">
        <h4 class="mb-3">üì° MITM Logs</h4>
        <div class="card shadow-sm border-0">
            <div class="card-body bg-light">
                <ul class="list-group list-group-flush">
                    {% for line in mitm_logs %}
                    <li class="list-group-item">
                        <span class="text-primary fw-bold">¬ª</span> {{ line }}
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Sniffing Logs -->
    {% if sniff_logs %}
    <section class="mt-5">
        <h4 class="mb-3">üïµÔ∏è Sniffing Logs</h4>
        <div class="card shadow-sm border-0">
            <div class="card-body bg-light">
                <ul class="list-group list-group-flush">
                    {% for log in sniff_logs %}
                    <li class="list-group-item">
                        <span class="text-danger fw-bold">‚ö†</span> {{ log }}
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </section>
    {% endif %}
</section>
{% endblock %}
