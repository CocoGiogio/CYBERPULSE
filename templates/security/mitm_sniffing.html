{% extends "base.html" %}

{% block content %}
<section id="mitm_sniffing" class="container mt-5 text-white">
    <div class="text-center mb-4">
        <h2 class="fw-bold mb-2">üíÄ MITM & Sniffing</h2>
        <p class="fs-5 text-white">
            Lancez une attaque Man-In-The-Middle et √©coutez le trafic HTTP en temps r√©el sur votre r√©seau local.
        </p>
    </div>

    <!-- MITM Start Form -->
    <div class="card bg-dark shadow-sm p-4 mb-4">
        <form method="POST" class="row justify-content-center g-3">
            <div class="col-md-4">
                <input type="text" class="form-control bg-secondary text-white border-0" name="gatewayIP"
                    placeholder="Ex: 192.168.1.1" required>
            </div>
            <div class="col-auto align-self-end">
                <button type="submit" class="btn btn-danger btn-lg shadow-sm">D√©marrer MITM</button>
            </div>
        </form>
    </div>

    <!-- Sniffer Start Form -->
    <div class="card bg-dark shadow-sm p-4 mb-4">
        <form method="POST" class="row justify-content-center g-3">
            <div class="col-md-4">
                <input type="text" class="form-control bg-secondary text-white border-0" name="interface"
                    placeholder="Ex: eth0 ou wlan0" required>
            </div>
            <div class="col-auto align-self-end">
                <button type="submit" class="btn btn-warning btn-lg shadow-sm">D√©marrer Sniffing</button>
            </div>
        </form>
    </div>

    <!-- MITM Logs -->
    {% if mitm_logs %}
    <section class="mt-5">
        <h4 class="mb-3 fw-bold">üì° MITM Logs</h4>
        <div class="card shadow-sm border-0 bg-secondary text-white">
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for line in mitm_logs %}
                    <li class="list-group-item bg-secondary text-white border-0">
                        <span class="text-primary fw-bold">¬ª</span> {{ line }}
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Sniffing Logs -->
    {% if sniff_logs %}
    <section class="mt-5">
        <h4 class="mb-3 fw-bold">üïµÔ∏è Sniffing Logs</h4>
        <div class="card shadow-sm border-0 bg-secondary text-white">
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for log in sniff_logs %}
                    <li class="list-group-item bg-secondary text-white border-0">
                        <span class="text-danger fw-bold">‚ö†</span> {{ log }}
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </section>
    {% endif %}
</section>
{% endblock %}